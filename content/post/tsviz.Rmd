---
title: "Time Series Visualization"
date: '2023-01-04'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(eval=FALSE, echo = TRUE)
```


As the coordinator of the Statistical Consultancy Service-University of Sri Jayewardenepura, I frequently receive requests from clients (particularly those in the Biological Science sector) who need assistance with visualizing time series data. This blog post is for them. For time series pre-processing, I'll be using R packages created by my PhD advisor Rob Hyndman, Professor Di Cook, Dr. Earo Wang, and a few other friends at Monash University, Australia, to carry out the visualizations.

# 1. R packages

Load necessary R packages 

```{r}
library(tidyverse)
library(tsibble)
```

# 2. Data 

For the illustrations I will be using daily average temperature values recorded in major cities of the world available. The corresponding dataset is available at https://www.kaggle.com/datasets/sudalairajkumar/daily-temperature-of-major-cities?resource=download

**Read data into R**

```{r}
data <- read_csv("city_temperature.csv")
```

```{r}
dim(data)
```

`dim(data)` output gives the number of rows and number of columns in the dataset. There are 2906327 rows and 8 columns.

I now view the first 10 few rows of the dataset to understand the format of the data.

```{r}
as.data.frame(head(data, 10))
```

To keep things simple I will illustrate this only for three cities. They are Charleston, Columbus and Portland.

```{r}
data_cha_col_por <- filter(data, City %in% c("Charleston", "Columbus", "Portland"))

head(data_cha_col_por)
```

# 3. Data Pre-processing

First I create a date column for my dataset. For each City I have 18530 data points.

```{r}
date = rep(as.Date("1995-01-01") + 0:18529, 3)

```

After that add date column to `data_cha_col_por` 

```{r}
data_cha_col_por$date <- date
```

Now we create the dataset into tsibble structure

```{r}
data_tsibble <- as_tsibble(data_cha_col_por,
                  index=date, key = c("Region", "Country", "State", "City"))
data_tsibble
```

# 4. Data visualization

## 4.1 Time series plots

```{r}
ggplot(data_tsibble,
       aes(x=date, y=AvgTemperature, col=City)) +geom_line()

```

## 4.2 