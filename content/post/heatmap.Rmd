---
title: "Heatmap with ggplot2"
date: "2021-12-16"
summary: "Heatmaps are used to show relationships between three variables, two plotted on each axis and cell color to show changes and magnitude of the third variable."
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, comment=NA, echo=FALSE}
library(xlsx)
library(here)
set.seed(2021)
a <- rnorm(100)
b <- rnorm(100)
c <- rnorm(100)
d <- rnorm(100)
e <- rnorm(100)
data <- data.frame(A=a, B=b, C=c, D=d, E=e)
path <- here("content", "post", "data.xlsx")
write.xlsx(data, path)

```

## Data Set

In this dataset there are three variables

1. ID (Time order is represented by row names.)

2. Species (There are 5 levels: A, B, C, D, E. This variable is spread across column names.)

3. Score (This is represented by the cell values.)

I want to plot head-map as follows

1. X-axis: ID

2. Y- axis: Species

3. Cell: score

```{r, comment=NA, echo=FALSE, comment=NA, message=FALSE, fig.height=2}
library(knitr)
include_graphics(here("content", "post", "heatmapdata.png"))
```


## Necessary packages

```{r, comment=NA, message=FALSE, warning=FALSE}
library(here)
library(tidyverse)
library(readxl)
```

## Read data

```{r, comment=NA, message=FALSE, eval=FALSE}
data <- read_excel("datafile.xlsx")
```

```{r, comment=NA, message=FALSE, echo=FALSE}
data <- read_excel(here("content", "post", "datafile.xlsx"))
```

```{r}
# View the first few rows of data
head(data)
```

## Convert data into the suitable format

```{r, comment=NA, message=TRUE, warning=FALSE}
data <- data %>% pivot_longer(!ID, names_to = "species", values_to = "score")
data$ID <- as.numeric(data$ID)
head(data)

```

## Plot heatmap

```{r, comment=NA, message=FALSE, fig.width=5}
ggplot(data, aes(y=ID, x=species, fill= score)) + 
  geom_tile(color = "white") +
  coord_equal()
```

